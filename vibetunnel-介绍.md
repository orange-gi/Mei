# VibeTunnel 项目介绍

## 为什么（Why）

### 解决的问题

在日常开发和运维工作中，终端会话管理一直是开发者面临的重要挑战。传统的终端解决方案要求开发者必须在物理设备前才能访问和控制终端会话，这给远程工作、移动办公和多项目并行开发带来了诸多不便。特别是在以下场景中，传统方案显得力不从心：

- **远程监控 AI 代理**：当使用 Claude Code、ChatGPT 或其他基于终端的 AI 工具时，开发者无法随时随地检查代理的运行状态和工作进度。
- **长时间构建任务**：启动一个需要数小时甚至数天的构建或部署任务后，开发者无法在离开办公室后继续监控任务进展。
- **团队协作与故障排查**：当团队成员遇到终端问题时，无法快速共享终端会话，导致协作效率低下。
- **移动办公需求**：开发者需要在手机或平板电脑上查看服务器日志或执行紧急命令，但传统的 SSH 方案在移动设备上体验不佳。

### 项目背景与动机

VibeTunnel 的诞生源于开发者对终端访问体验的深刻反思。传统的远程终端解决方案（如 SSH、VNC 等）虽然功能强大，但存在以下固有缺陷：

- **配置复杂**：SSH 需要处理密钥管理、端口转发、防火墙规则等问题，对于非技术用户而言门槛较高。
- **跨平台体验差**：在移动设备上使用 SSH 客户端体验不佳，缺乏针对触控优化的界面。
- **缺乏现代化功能**：传统方案无法与现代开发工作流深度集成，如 Git 分支跟踪、会话录制与回放等。
- **安全性配置困难**：正确配置 SSH 密钥、VPN 等安全机制需要专业知识，容易因配置不当留下安全漏洞。

VibeTunnel 的核心动机是打造一个**零配置**、**跨平台**、**现代化**的终端访问解决方案，让开发者能够像访问普通网页一样轻松访问终端会话。

### 目标用户群体

VibeTunnel 主要面向以下用户群体：

- **AI 开发者**：需要远程监控 Claude Code、ChatGPT CLI 等 AI 代理的运行状态。
- **DevOps 工程师**：需要随时检查 CI/CD 流水线状态、服务器日志和后台任务。
- **远程工作者**：经常在办公室以外的地方工作，需要远程访问开发环境。
- **技术团队负责人**：需要监控团队成员的终端活动，确保项目进度正常。
- **教育工作者**：在远程教学场景中需要向学生展示终端操作。

## 是什么（What）

### 项目概述

VibeTunnel 是一个开源的 macOS 应用程序，它能够将终端会话代理到任何 Web 浏览器中，让用户能够随时随地访问和控制终端。该项目采用现代化的技术栈构建，包括 Swift/SwiftUI 原生应用、TypeScript/Node.js 服务器和 Lit Web 前端，实现了一个完整的终端多路复用解决方案。

项目的核心理念是「Turn any browser into your terminal」，即让任何浏览器都能变成你的终端。通过 VibeTunnel，用户无需安装额外的客户端软件，仅需打开浏览器即可访问本地终端会话，大大简化了终端访问的流程。

### 核心功能特性

VibeTunnel 提供了丰富的功能集，满足各种终端访问需求：

- **基于浏览器的终端访问**：支持在任何现代浏览器中访问终端会话，包括 Chrome、Safari、Firefox 和移动端浏览器。终端渲染使用 ghostty-web 技术，提供接近原生终端的体验。

- **零配置启动**：安装后即可直接使用，无需配置 SSH 密钥、端口转发或 VPN。所有配置均可通过直观的图形界面完成，降低了使用门槛。

- **AI 代理友好**：专为监控 Claude Code、ChatGPT CLI 等 AI 工具设计，提供会话活动指示器，实时显示哪些会话正在活跃运行。

- **Git 跟随模式**：终端能够自动跟随 Git 工作树的分支切换，保持主仓库与工作树的同步，让 IDE 和服务器持续运行而无需重启。

- **智能键盘处理**：支持可切换的键盘捕获模式，使用 Cmd+1-9/0（Mac）或 Ctrl+1-9/0（Linux）快速在不同会话间切换。

- **多因素认证支持**：提供多种认证模式，包括系统认证、环境变量认证、SSH 密钥认证和无认证模式，满足不同安全需求。

- **移动端适配**：原生 iOS 应用配合响应式 Web 界面，支持在 iPhone 和 iPad 上流畅使用。

- **会话录制**：支持以 asciinema 格式录制会话，便于后续回放和分享。

- **高性能架构**：基于 Node.js 的优化服务器，资源占用极低，响应速度极快。

- **Apple Silicon 原生优化**：针对 M1 及以上芯片进行了深度优化，提供最佳性能和能效表现。

- **Shell 别名支持**：用户的自定义别名和 Shell 函数能够自动在 VibeTunnel 会话中正常工作。

### 技术栈概述

VibeTunnel 采用多层次的技术架构，各组件协同工作：

| 组件 | 技术栈 | 主要职责 |
|------|--------|----------|
| macOS 菜单栏应用 | Swift/SwiftUI | 管理服务器生命周期、菜单栏集成、系统集成 |
| iOS 应用 | Swift/SwiftUI | 移动端终端访问、推送通知 |
| Web 服务器 | TypeScript/Node.js/Bun | 终端会话管理、WebSocket 处理、API 服务 |
| Web 前端 | TypeScript/LitElement | 终端渲染、用户界面、WebSocket 通信 |
| 终端仿真 | ghostty-web | 高性能终端渲染 |
| PTY 管理 | node-pty | 原生伪终端支持 |

### 与竞品的差异化

与市面上现有的终端访问解决方案相比，VibeTunnel 具有以下显著优势：

- **对比 SSH/VNC**：无需复杂的网络配置，支持浏览器直接访问，提供现代化 UI，集成 Git 工作流。

- **对比 tmux/screen**：提供图形化界面和远程访问能力，不局限于单一终端窗口，支持团队协作。

- **对比传统 Web 终端（如 Wetty）**：原生 macOS 应用支持、更完善的会话管理、内置 AI 代理优化。

- **对比商业解决方案（如 Teleport）**：开源免费、轻量级部署、无需专用基础设施。

## 如何做（How）

### 快速开始

#### 安装选项

VibeTunnel 提供两种主要的安装方式，用户可以根据自己的需求选择：

**方式一：macOS 应用程序（推荐）**

适用于希望在菜单栏中快速访问 VibeTunnel 的 Mac 用户。应用程序提供原生的菜单栏集成和自动更新功能。

下载方式包括：
- 直接下载：访问 GitHub Releases 页面下载最新版本，拖动到「应用程序」文件夹即可。
- Homebrew 安装：执行 `brew install --cask vibetunnel` 一键完成安装。

**方式二：npm 包（适用于 Linux 和无头系统）**

适用于 Linux 服务器、Docker 容器或无头 macOS 系统。

```bash
npm install -g vibetunnel
```

#### 启动与访问

1. **启动 VibeTunnel**：macOS 用户点击菜单栏图标启动服务，npm 包用户直接执行 `vibetunnel` 命令。

2. **打开仪表板**：在浏览器中访问 http://localhost:4020 查看所有终端会话。

3. **使用 vt 命令转发会话**：

```bash
# 转发任何命令到浏览器
vt pnpm run dev
vt npm test
vt python script.py

# 使用 Shell 别名
vt gs              # 你的 'git status' 别名
vt claude-danger   # 自定义别名

# 打开交互式 Shell
vt --shell

# Git 跟随模式
vt follow          # 跟随当前分支
vt follow main     # 切换到 main 并跟随
vt unfollow        # 停止跟随
```

### 核心使用方式

#### 会话管理

VibeTunnel 的会话管理是其核心功能之一。用户可以：

- **创建新会话**：使用 `vt` 命令或在 Web 界面中创建新会话。
- **查看活跃会话**：在仪表板中查看所有运行中的会话，包括最近活动和状态指示。
- **切换会话**：使用键盘快捷键在多个会话间快速切换。
- **录制会话**：所有会话自动录制为 asciinema 格式，便于回放。

#### 远程访问配置

VibeTunnel 提供多种远程访问方式，用户可以根据安全需求选择：

**Tailscale 方案（推荐）**

创建安全的点对点 VPN 网络，流量保持在私有网络中：

1. 在 Mac 和远程设备上安装 Tailscale。
2. 使用相同账户登录。
3. 访问 http://[你的主机名].tailnet-name.ts.net:4020。

支持两种访问模式：
- **Private 模式**：仅在 Tailscale 网络内可访问。
- **Public 模式**：通过 Tailscale Funnel 向公网开放。

**ngrok 方案**

创建安全隧道到本地服务器，生成公共 URL：

1. 在 ngrok 仪表板获取认证令牌。
2. 在 VibeTunnel 设置中配置令牌。
3. 启用 ngrok 隧道，共享生成的 https://[随机].ngrok-free.app URL。

**本地网络方案**

1. 在设置中切换到「网络」模式。
2. 配置认证方式。
3. 通过 http://[你的 Mac IP]:4020 访问。

### 关键配置说明

#### 认证配置

VibeTunnel 支持多种认证模式：

```bash
# 系统认证（默认）
# 使用 macOS 本地用户账户

# 环境变量认证
export VIBETUNNEL_USERNAME=admin
export VIBETUNNEL_PASSWORD=secure-password
vibetunnel --bind 0.0.0.0

# SSH 密钥认证
vibetunnel --enable-ssh-keys

# 禁用认证（仅限受信任环境）
vibetunnel --no-auth

# 本地旁路认证（开发环境）
vibetunnel --allow-local-bypass --local-auth-token mytoken
```

#### 终端标题管理

```bash
# 静态模式：显示工作目录和命令
vt --title-mode static npm run dev

# 过滤模式：阻止应用程序更改标题
vt --title-mode filter vim

# 无模式：应用程序控制自己的标题
vt --title-mode none npm run dev
```

#### 日志级别控制

```bash
# 安静模式 - 仅错误
vt -q npm test

# 默认模式 - 错误和警告
vt npm test

# 详细模式 - 错误、警告和信息
vt -v npm run dev

# 调试模式 - 所有日志
vt -vvv python app.py
```

### 最佳实践建议

#### 开发工作流集成

- **AI 代理监控**：使用 `vt claude` 或 `vt claude --dangerously-skip-permissions` 启动 AI 代理，通过仪表板实时监控其活动。
- **多项目开发**：利用 Git 跟随模式在不同分支的工作树间切换，保持 IDE 和开发服务器持续运行。
- **团队协作**：通过 Tailscale 与团队成员共享终端会话，便于实时协作和故障排查。

#### 安全最佳实践

- **始终使用认证**：除非在完全受信任的环境中，否则不要禁用认证。
- **使用 HTTPS**：在生产环境中通过反向代理（nginx、Caddy）启用 HTTPS。
- **定期轮换凭证**：定期更换认证凭证，避免长期使用相同密码。
- **优先使用 SSH 密钥**：相比密码认证，SSH 密钥提供更强的安全性。
- **监控访问日志**：定期检查日志，关注异常的认证模式。

#### 性能优化

- **使用自定义 Node.js 构建**：项目支持构建优化版的 Node.js，可减少约 46% 的可执行文件大小（从 107MB 降至 61MB）。
- **利用开发服务器模式**：Web 开发时启用开发服务器模式，避免每次修改后重新构建整个应用。
- **合理使用会话录制**：在不需要录制回放的场景中禁用录制，减少磁盘 I/O 和存储空间占用。

---

VibeTunnel 通过现代化的技术栈和精心设计的工作流，为开发者提供了一个强大而易用的终端访问解决方案。无论是日常开发、远程办公还是 AI 代理监控，VibeTunnel 都能显著提升终端使用体验和工作效率。
