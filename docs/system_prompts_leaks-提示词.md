# System Prompts Leaks 提示词分析

## 提示词位置总览

项目包含多个AI服务商的系统提示词,主要分布在以下目录:

```
system_prompts_leaks/
├── Anthropic/              # Claude系列提示词
│   ├── claude-4.5-sonnet.md
│   ├── claude-3.7-sonnet-w-tools.md
│   ├── claude-code.md
│   └── ...
├── OpenAI/                # GPT系列提示词
│   ├── GPT-4o.md
│   ├── gpt-5-thinking.md
│   └── ...
├── Google/                # Gemini提示词
├── xAI/                   # Grok提示词
└── ...
```

## Anthropic Claude 提示词分析

### Claude 4.5 Sonnet 完整提示词

**文件位置**: `Anthropic/claude-4.5-sonnet.md`

**核心组件分析**:

```
1. 引用指令系统 (Citation Instructions)
   - 描述: 定义如何正确引用网络搜索和工具结果
   - 关键标签: <citation_instructions>
   - 功能: 确保AI响应有据可查,避免无根据的声明

2. 过去对话工具 (Past Chats Tools)
   - 描述: 提供搜索历史对话的能力
   - 触发模式: 检测用户引用过去对话的信号
   - 工具: conversation_search, recent_chats

3. 计算机使用工具 (Computer Use)
   - 描述: 定义Linux计算机环境的使用规则
   - 技能系统: docx, pdf, pptx, xlsx
   - 文件处理: 上传文件、创建文件、编辑文件

4. 可用技能 (Available Skills)
   - 描述: 定义可用的文档处理技能
   - 技能列表:
     * docx: Word文档处理
     * pdf: PDF操作
     * pptx: 演示文稿制作
     * xlsx: 电子表格处理

5. Artifacts功能
   - 描述: 支持创建多种类型的可渲染内容
   - 支持格式: HTML, React, Mermaid, SVG, PDF, Markdown
   - 限制: 不使用localStorage/sessionStorage

6. 文件处理规则 (File Handling Rules)
   - 用户上传: /mnt/user-data/uploads
   - 工作目录: /home/claude
   - 输出目录: /mnt/user-data/outputs

7. 分享文件规则 (Sharing Files)
   - 使用computer://链接
   - 提供简洁的总结
   - 直接链接到文件

8. 包管理 (Package Management)
   - npm: 正常工作
   - pip: 需要--break-system-packages
   - 虚拟环境: 按需创建

9. 搜索指令 (Search Instructions)
   - 网络搜索规则
   - 查询复杂度分类
   - 版权要求
   - 有害内容安全准则

10. 用户偏好信息 (Preferences Info)
    - 行为偏好: 如何适应用户行为
    - 情境偏好: 背景信息应用规则
    - 应用条件: 何时使用用户偏好信息
```

### Claude Code 提示词分析

**文件位置**: `Anthropic/claude-code.md`

**设计特点**:

1. **工具集定义**: 定义了代码开发相关的工具
2. **代码质量要求**: 强调代码的完整性和功能性
3. **错误处理**: 明确错误处理和异常情况处理
4. **测试要求**: 包含代码测试和质量保证

### Claude 3.7 Sonnet with Tools

**文件位置**: `Anthropic/claude-3.7-sonnet-w-tools.md`

**工具定义模式**:

- **工具分类**: 搜索、文件操作、代码执行等
- **参数规范**: 明确的参数定义和使用规则
- **使用限制**: 工具使用的边界条件

## OpenAI GPT 提示词分析

### GPT-4o 系统提示词

**文件位置**: `OpenAI/GPT-4o.md`

**核心组件**:

```
1. 身份定义
   - 角色: ChatGPT
   - 训练方: OpenAI
   - 知识截止: 2024-06
   - 当前日期: 2025-06-04

2. 图像能力
   - 状态: 启用
   - 安全策略:
     * 不识别真实人物
     * 不推断种族、信仰等
     * 不进行不当评论

3. 工具系统
   - bio: 记忆持久化
   - file_search: 文件搜索
   - python: 代码执行
   - web: 网络访问
   - guardian_tool: 内容策略查询
   - image_gen: 图像生成
   - canmore: 画布文档创建

4. 响应风格
   -  Personality: v2
   -  交互方式: 温暖但诚实
   -  专业性: 保持专业和务实

5. 搜索工具
   - 文件搜索: 支持多查询
   - 引用格式: 【{message idx}:{search idx}†{source}】
   - 限制: 最多5个查询
```

### GPT-5 Thinking 提示词

**文件位置**: `OpenAI/gpt-5-thinking.md`

**独特设计**:

1. **隐藏思维链**
   - 内部推理过程不向用户展示
   - 决策透明度与效率平衡

2. **即时执行模式**
   - 不进行异步后台工作
   - 要求在当前响应中完成任务

3. **详细程度控制**
   - oververbosity参数(1-10)
   - 默认值为3
   - 根据任务调整详细程度

4. **工具使用规则**
   - 必须在analysis通道使用python
   - 内部推理使用python分析
   - 用户可见代码使用python_user_visible

5. **Web工具增强**
   - 图像查询(最多2个)
   - 产品查询(最多8-12个)
   - 丰富的UI元素支持

6. **响应风格要求**
   - 自然、健谈、Playful
   - 避免正式、机器人化
   - 保持一致的风格

7. **关键安全指令**n   - 拒绝+重定向: 提供清晰解释和替代方案
   - 谜题/偏见测试: 仔细审题
   - 算术计算: 逐步计算确保准确

8. **复杂任务处理**
   - 优先部分完成
   - 不询问澄清问题
   - 诚实说明已完成和未完成部分

## 提示词设计模式分析

### 1. 结构化组织模式

**模式特点**:

```
提示词结构:
├── 元信息区 (知识截止日期、版本)
├── 角色定义区 (身份、能力)
├── 工具定义区 (可用工具、参数)
├── 行为规则区 (约束、限制)
├── 安全准则区 (过滤规则)
└── 输出规范区 (格式、风格)
```

**优势**:
- 清晰的信息层次
- 便于维护和更新
- 支持模块化修改

### 2. 动态指令注入模式

**实现方式**:

```
<instruction_type>
指令内容
</instruction_type>

示例:
<citation_instructions>
具体引用规则...
</citation_instructions>

<search_instructions>
搜索使用规则...
</search_instructions>
```

**优势**:
- 便于识别特定功能
- 支持选择性解析
- 增强可读性

### 3. 工具定义模式

**通用模板**:

```
## 工具命名空间
type tool_name = (_: {
    param1: type,
    param2: type,
    // 参数描述
}) => any;

// 使用说明
描述工具的功能和使用场景
```

**特点**:
- 明确的参数定义
- 返回类型规范
- 使用示例和限制

### 4. 条件触发模式

**实现示例**:

```
// 触发条件检测
<trigger_patterns>
用户信号模式列表
</trigger_patterns>

<tool_selection>
工具选择决策逻辑
</tool_selection>

<decision_framework>
决策流程框架
</decision_framework>
```

**优势**:
- 智能响应触发
- 上下文感知能力
- 减少不必要的操作

### 5. 分层约束模式

**约束层次**:

```
第一层: 系统级约束 (核心行为)
├── 必须遵循的规则
├── 禁止的行为
└── 关键限制条件

第二层: 功能级约束 (工具使用)
├── 工具调用条件
├── 参数限制
└── 使用频率限制

第三层: 内容级约束 (输出规范)
├── 内容过滤规则
├── 格式要求
└── 风格指导
```

## 变量和模板系统

### 1. 动态内容变量

**常见变量类型**:

```
// 元信息变量
{{currentDateTime}}     // 当前时间
{{knowledgeCutoff}}      // 知识截止日期
{{userLocation}}         // 用户位置

// 用户信息变量
{{user_tz_area}}         // 用户时区区域
{{user_tz_location}}     // 用户时区位置
{{PREFERRED_NAME}}       // 用户偏好名称
```

### 2. 条件模板

**实现模式**:

```
// IF-THEN模式
IF 条件 THEN 动作

// 示例:
IF 用户引用过去对话 THEN 使用past_chats工具
IF 需要实时信息 THEN 使用web搜索
```

### 3. 重复模式提取

**常见模式库**:

```
// 引用模式
<citation_instructions>
引用规则...
</citation_instructions>

// 工具定义模式
type tool_name = (_: {...}) => any;

// 决策框架模式
<decision_framework>
决策逻辑...
</decision_framework>
```

## 优化建议

### 1. 提示词结构优化

**建议**:

```
当前问题:
- 某些提示词过于冗长
- 嵌套结构复杂
- 难以快速定位特定功能

改进方案:
1. 使用明确的章节标题
2. 提供目录索引
3. 分离核心规则和详细说明
```

### 2. 工具定义标准化

**建议**:

```
当前问题:
- 不同提示词的工具定义格式不一致
- 缺少统一的参数描述规范

改进方案:
1. 建立标准化的工具定义模板
2. 统一参数描述格式
3. 提供工具使用示例库
```

### 3. 条件逻辑简化

**建议**:

```
当前问题:
- 决策框架过于复杂
- 条件判断嵌套层数过多

改进方案:
1. 简化决策流程
2. 使用表格化的条件映射
3. 提供快速参考卡片
```

### 4. 版本管理增强

**建议**:

```
当前状态:
- 版本信息记录在提示词内部
- 缺少显式的版本追踪机制

改进方案:
1. 使用YAML front matter记录版本
2. 提供版本变更日志
3. 支持版本对比功能
```

### 5. 社区贡献优化

**建议**:

```
当前问题:
- 缺少标准化的贡献指南
- 验证流程不明确

改进方案:
1. 创建详细的贡献文档
2. 提供自动验证工具
3. 建立审查流程和标准
```

## 关键设计原则总结

### 1. 清晰性原则

```
✓ 使用明确的语言
✓ 避免歧义表达
✓ 提供具体示例
✓ 层次分明的结构
```

### 2. 一致性原则

```
✓ 术语使用一致
✓ 格式规范统一
✓ 风格保持一致
✓ 命名规范统一
```

### 3. 可维护性原则

```
✓ 模块化设计
✓ 清晰的注释
✓ 易于更新和扩展
✓ 版本控制友好
```

### 4. 可扩展性原则

```
✓ 支持新增工具
✓ 易于添加功能
✓ 兼容未来变化
✓ 插件化架构
```

### 5. 安全性原则

```
✓ 明确的边界限制
✓ 内容过滤规则
✓ 错误处理机制
✓ 隐私保护措施
```
